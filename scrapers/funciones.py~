# -*- coding: utf-8 -*-
import pandas as pd
from collections import Counter
import matplotlib.pyplot as plt

def get_diccionario(descripcion):
    tecnologias_lista=[]
    for word in  descripcion:
        for tecno in tecnologias_todas: 
            if tecno in word: 
                tecnologias_lista.append(tecno)
    tecnologias=Counter(tecnologias_lista).most_common(10)
    #tecnologias=Counter(tecnologias_lista)
    print(dict(tecnologias))
    return(dict(tecnologias))

def crear_grafica(tecnologias,total_empleos):
    valores=dict(tecnologias)
    manzanas = valores.values()
    nombres = valores.keys()
    plt.pie(manzanas, labels=nombres, autopct="%0.1f %%")
    plt.title("Los 10 más populares en "+str(total_empleos)+" empleos", bbox={'facecolor':'0.8', 'pad':5})
    plt.show()

col_list = ["DESCRIPCION", "EXPERIENCIA"]
df=pd.read_csv('DATOS_COMPUTRABAJO\\2020-07-05_00_16_09\\URL_2020-07-05_00_16_09.csv', sep=',',encoding = "ISO-8859-1",usecols=col_list)
list1=df["EXPERIENCIA"]
anios_experiencia = Counter(list1)

df=df.drop_duplicates()


descripcion_todas=[]
descripcion_1=[]
descripcion_2=[]
descripcion_3=[]
descripcion_4=[]
descripcion_5=[]
descripcion_6=[]
descripcion_nada=[]
contador=0
 
for descr in  df["DESCRIPCION"]:
     
    experiencia=str(df["EXPERIENCIA"].values[contador])
    if experiencia=="1":
        descripcion_1.append(descr)
    if experiencia=="2" or experiencia=="3":
        descripcion_2.append(descr)
    if experiencia=="4" or  experiencia=="5":
        descripcion_3.append(descr)
    if experiencia=="6":
        descripcion_4.append(descr)
     
    if experiencia=="N/D":
        descripcion_nada.append(descr)
    contador+=1
 
 
tecnologias=""" web, móvil, SEO, Redes sociales,ingles, E-Commerce, contenido,campañas,posicionamiento,
                SEO,SEM, Analytics,Facebook, Instagram, segmentación de targets,CRM ,comunicación verbal, Facebook Ads, Business Facebook,
                Email marketing,estrategia de Marketing,Web Design, Social Media , Publicidad online,WebTrends,Google Analytics, Google Adwords,
                Excel, Outlook, Windows, Ilustrator, Photoshop, Servidores de E-mail,  Márketing estratégico,  After Effects, Premier, 
                InDesign, Microsoft Office,Google ADS,WordPress, Data Studio, Search Console, Woocommerce,Tag Manager,KPI,Lightrooom,Social Media,
                Presta Shop,Google Trends,MKT,SQL, PHP, HTMl, CSS,Whatsapp, Youtube"""
                
tecnologias=tecnologias.split(",")  
tecnologias=map(str.strip, tecnologias)
tecnologias_todas=set(tecnologias) 

 
conjunto=df["DESCRIPCION"]

tecnologias=get_diccionario(conjunto)
crear_grafica(tecnologias,len(conjunto))
 